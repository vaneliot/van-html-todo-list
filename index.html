<!DOCTYPE html>
<html lang="en">
    <head>
        <title>To Do List</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- <link href="css/style.css" rel="stylesheet"> -->
        <style>
            body {
                font-family: Calibri, Tahoma, Roboto, sans-serif;
                background-color: #243447;
                color: cyan;
            }
            .container {
                margin: auto;
                display: flex;
                flex-wrap: wrap;
                flex-direction: column;
                align-content: center;
                
            }
            
            .container > * {
                text-align: center;
                width: 60%;
                
            }

            input[type="text"] {
                margin: auto;
            }
            #add-todo {
                background-color: #7186a0;
                font-weight: bold;
                margin: auto;
                color: cyan;
                border-radius: 5px;
                margin-top: .5em;
            }

            li {
                list-style-type: none;
            }

            .flex-container {
                display: flex;
                flex-direction: row;
                flex-wrap: wrap-reverse;
                /* flex-flow: row wrap */
                position: relative;
                left: -1.2em;
            }

            .flex-item {
                background-color: #7186a0;
                border: 1px solid black;
                text-align: center;
                width: 100%;
                margin: 0.1em;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <h1>My To-Do List</h1>
            <input id="todo-title" type="text" name="todo-title" placeholder="title" required>
            <input id="todo-desc" type="text" name="todo-desc" placeholder="description">
            <button id="add-todo">+Add</button>
            <br/ >
            <ul id="todo-list" class="flex-container">
                
            </ul>
        </div>
        <script>
            var db = window.localStorage;
            // var todos = [
            //     {
            //         title: 'do homework',
            //         desc: 'yea'
            //     },
            //     {
            //         title: 'foo',
            //         desc: 'bar'
            //     }
            // ];

            // db.setItem("todos", JSON.stringify(todos));
            let todos = JSON.parse(db.getItem('todos')) != null ? JSON.parse(db.getItem('todos')) : []; 
            
            var todoTitle = document.querySelector('#todo-title');
            var todoDesc = document.querySelector('#todo-desc');
            var addTodoBtn = document.querySelector('#add-todo');

            var todoList = document.querySelector('#todo-list');

            console.log(db);

            class Todo {
                constructor(title, desc) {
                    this.title = title
                    this.desc = desc
                }
            }

            var addTodo = () => {
                console.log('foo');
                let newTodo = new Todo(todoTitle.value, todoDesc.value);
                // console.log(newTodo);
                todos.push(newTodo);
                db.setItem("todos", JSON.stringify(todos));
                loadToList(todos)
            }

            addTodoBtn.addEventListener('click', addTodo)


            // load todos from db to todos array
            var loadToList = (tempDb) => {
                todoList.innerHTML = '';
                for(let i=0; i<tempDb.length; i++) {
                    let li = document.createElement('li');
                    let div = document.createElement('div');
                    li.setAttribute('class', 'flex-item')
                    let titleText = document.createTextNode(tempDb[i].title);
                    let descText = document.createTextNode(tempDb[i].desc);
                    
                    let heading = document.createElement('h4');
                    let p = document.createElement('p');
                    heading.appendChild(titleText);
                    p.appendChild(descText);

                    div.appendChild(heading)
                    div.appendChild(p)

                    li.appendChild(div);
                    todoList.appendChild(li);
                }
            }

            // upon page load
           
            let tempDb = JSON.parse(db.getItem('todos'));
            if(tempDb != null) {
                loadToList(tempDb);
            }


            // Execute a function when the user releases a key on the keyboard
            // todoTitle.addEventListener("keyup", function (e) {
            //     // Number 13 is the "Enter" key on the keyboard
            //     if (e.keyCode === 13) {
            //         // Cancel the default action, if needed
            //         e.preventDefault();
            //         // Trigger the button element with a click
            //         todoTitle.click();
            //     }
            // }); 
        </script>
    </body>
</html>